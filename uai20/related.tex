\section{Related work}
\label{sec:rl}

%\begin{itemize}
%\item on SBM and WSBM (Clauset/peixoto)
%\item on MMSB familly (Airoldi/Blei/Mimmo/Gopalan) and SVB
%\item on PFA (Poisson Factor Analysis) and Gamma Processes (Zhou etc).
%\item on SCVB (Foulds). (they show that scvb is similar to EM+map on made the links with online EM of (Capp√© and Moulines)
%\end{itemize}
In social networks, the presence of a tie between two entities generally indicates that there is a relationship between them and in recent years, researchers proposed various methods to predict the presence or absence of such interaction. However, in many applications, it is the intensity of the relationship that is important. So, for example in epidemiology, it is not enough to know that two people have been in contact but it is also necessary to know the frequency of these contacts to know whether there is a risk of contagion or not. Similarly, in the field of transport, it is not enough to know that there is a motorway or an airline between two cities to analyze the population flows between them, it is also necessary to know the number of vehicles or passengers that goes from the first one to the other. In the field of economy and finance, to know if a company risks being absorbed by another it is not enough to know that the second took shares in the capital of the second but it is also necessary to know how much. This intensity of the relationship is generally modeled as a weight and the network is represented by a weighted graph. Unfortunately, in practice it is often easier to observe the interaction than to measure it. For this reason, there has been a lot of work devoted to link prediction \cite{Liben2007, Zaki2011,  Martinez2016}  %Wang2014
and less to edge weight prediction in social networks.


Like for link prediction, to solve the weight prediction, there are two main approaches, similarity-based and likelihood-based methods \cite{Lu2011}. The methods belonging to the first familly assume that the similarity between two nodes is correlated with their interaction strength. For instance, using this hypothesis, Zhao \textit{et al.} propose to predict missing links and their weights by extending unweighted similarity indices to weighted ones \cite{Zhao2015}. Zhu \textit{et al.} also introduce a method where the estimation of the weights is based on neighbor sets \cite{Zhu2016}.
The second approach formulates the problem in a probabilistic framework and includes extended versions of generative models, initially introduced to learn the network formation process, in particular, the stochastic block model (SBM) \cite{Karrer2011} \textit{CL :ref  Karrer ou Nowicki and Snijders?}.  
However, these models suffer from several limitations notably they consider that a node can  belong to only one class, which is not realistic in real networks and, secondly the inference algorithm is not able to tackle large size networks. The models and inference process presented in this paper aim to overcome these limits. 


The original MMSB model was proposed in \cite{airoldi2009mixed} with a variational inference scheme. The inference process was later extended with stochastic variational inference in \cite{gopalan2013efficient} and structured variational inference in \cite{kim2013efficient} for scalability purposes. Stochastic variational inference has been applied with a collapsed variational objective for the latent Dirichlet allocation model \cite{foulds2013stochastic}\sout{. To} \textit{and to} our knowledge, it is the first time that stochastic and collapsed variational inference are coupled in the context of stochastic block models. \textit{However, the previous models have been designed for link prediction and not for weight prediction.  }

\textit{Weighted versions of the stochastic block model have been intoduced firstly in \cite{mariadassou2010} and then in} \cite{aicher2014learning} who proposed WSBM. WSBM can be seen as a special case of our WMMSB model  in which nodes are constrained to belong to only one latent class \textit{whereas our model allows each node to belong to several classes}. More recently, an extended version of WSBM  model has been presented  in which different kernels can be used to model different types of weights \cite{peixoto2018nonparametric}. An efficient MCMC method is used for inference. If this type of models is interesting, it nevertheless relies again on the assumption that a node belongs to only one class, which may be inappropriate for real world networks. Furthermore, unlike MMSB models, the lack of a hierarchical prior structure does not allow one to rely on efficient non-parametric extensions (hence the use of costly model selection techniques for non-parametric versions). 

Similar to our model, count processes with Poisson distributions and Gamma conjugate priors have been studied \sout{by different authors} \textit{notably by Zhou et al.} \cite{zhou2012augment, zhou2015negative}. The relation of such processes with Negative Binomial processes is well-known and has been highlighted by these authors who applied  these processes for topic modeling, \sout{as} \textit{with} the Beta-Gamma-Gamma-Poisson model (EPM) (\cite{zhou2012beta}) that relies on MCMC inference. They also applied them for  overlapping community detection and link prediction \cite{zhou2015infinite}. The main difference between this model and WMMSB is that the former factorizes counts as Poisson variables of a sum of latent factors while, in WMMSB, counts are factorized as a convex sum of Poisson variable depending on class memberships.

Thus, the main theoretical contribution of this article is two-fold: firstly, we propose a mixed-membership stochastic block model, called WMMSB-bg, for weighted networks allowing nodes to belong to several classes, and secondly we \sout{show how to learn this model on large networks with a stochastic collapsed variational inference algorithm} \textit{design an efficient stochastic collapsed variational inference algorithm able to handle large size networks}.

%
%This work intersects with several groups of related works:
%
%First, the recent advance on Stochatistic Variationnal inference have made it possible to scale bayesian model to bigger dataset and to do online learning which enable a low memory footprint. This inference have first been proposed for topic modeling [1][2] before being adapted for the MMSB model with an adaptation to discover overllaping communities [3] [4],
%
%Nevertheless, the previous works only study the case of (undirected) binary networks.
%
%In [5] the author proposed an efficient inference algorithm for weigthed networks, based on a MCMC algorithms. The model is an extension of the SBM. Those models assumed that the class don't overllap. (I still have to dive into to understand how his inferecne works...) (does it allow online learning ? )
%
%Finally, SVB has been combined with CVB inference for topic modelling to propose a improoved over SVB. [6]
%
%This paper combines the different advantage of those works to propose a Online learning algorithm to models networks that can be weighted, with overllaping classes, directed or undirected.
%

