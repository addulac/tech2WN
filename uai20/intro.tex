\section{Introduction}

Link prediction in networks is a well-known problem that has been addressed by many studies. If knowing that a link relates two nodes in a network is important, the intensity of each link plays a major role in many situations. For example, in epidemiology, the number of contacts between two persons is an important factor to accurately estimate the probability of contagion between two persons. Similarly, to understand the population dynamics between two cities, it is not sufficient to know that there is a motorway or an airline relating them, it is also necessary to know the number of vehicles or passengers that transit between them. In the fields of economy and finance, to estimate whether a company will be controlled by another company which has recently acquired part of its shares, it is important to know the actual number of shares acquired. In all these examples, the relations between the entities involved (persons, cities, companies) can be modeled by weighted graphs, in which the weight on each link represents the intensity of the relationship between the nodes. Inferring the values of the weights between nodes in such graphs is known as the weight prediction problem.

%, in which entities correspond to nodes and relations, as contacts between persons, transport connections between cities and acquisitions between companies, to links. 
If weights in weighted graphs can sometimes take both positive and negative values, as in \textit{signed} social networks for representing approval/disapproval, like/dislike or trust/distrust, most weighted networks rely on positive integers. The prevalence of this type of networks may be explained by the fact that many weighted networks are the result of the superposition, over time, of atomic, binary interactions. In communication networks for example, as in email networks, edges are weighted according to the number of exchanges between nodes, the atomic interaction being a single exchange. Similarly, in co-authorship networks, edges are weighted according to the number of collaborations between authors \cite{newman2001scientific}, while in text mining and natural language processing applications word graphs are weighted on the basis of the number of times the words co-occur (in a sentence, a paragraph or a document).

Two main approaches have been proposed to solve the weight prediction problem in networks. In the first type of approaches, one finds methods that assume that the weight of a link is correlated with the similarity between the nodes of the link, this similarity being based on neighboring nodes \cite{Zhao2015,Zhu2016}. If the assumption ''a node behaves like its neighbors'' is used, to different extent, in network studies, it is however not sufficient to explain all the observed interactions between nodes. Several researchers have thus adopted a second type of approaches, based on generative models within well-defined probabilistic frameworks. Such models aim at making explicit how links, and their weights, are produced. Among such generative models, stochastic block models and their extensions through mixed-membership stochastic block models have received particular attention \cite{ Karrer2011,airoldi2009mixed,iMMSB,fan2015dynamic} as they can account for the underlying classes that structure real-world networks. Nevertheless, most models proposed so far have been devoted to unweighted networks and, to our knowledge, only two models in the stochastic block model family have been proposed for weighted graphs: The latent block structure model of \cite{aicher2014learning} and the weighted stochastic block model of \cite{peixoto2018nonparametric}. These two models however suffer from the same drawback as standard stochastic block models, namely the fact that a node can belong to only one class, which is not realistic for many networks and can be corrected through mixed-membership block models.% were specifically designed to overcome this limitation.

We thus propose in this study:
%
\begin{enumerate}
\item New mixed-membership block models that can solve the weight prediction problem on networks in which weights are positive integers.
\item A scalable inference method, based on a combination of collapsed and stochastic variational inference, for deploying the above models on large networks.
\item An experimental illustration the behavior of these models on several real-world networks.
\end{enumerate}
%
The remainder of the paper is organized as follows: Section~\ref{sec:rl} describes related work; Section~\ref{sec:model} then presents the weighted mixed-membership stochastic block models we retained while Section~\ref{sec:inference} details its inference. Section~\ref{sec:exps} illustrates the behavior of the proposed models on several real-world networks. Finally, Section~\ref{sec:concl} concludes the study.


%From social networks to protein interactions, from physics to linguistics, networks are one of the key representations for objects interacting with one another. The interest for modeling such networks has naturally increased with the availability of large datasets, and people have tried to design generative models to describe the formation of links between nodes. Among such generative models, stochastic block models and their extensions through mixed-membership block models have received particular attention \cite{airoldi2009mixed,iMMSB,fan2015dynamic} as they can account for the underlying classes that structure real-world networks and in particular social networks. Nevertheless, most models proposed so far are devoted to unweighted networks. To our knowledge, only two models, in the stochastic block model family, have been proposed for weighted graphs: the latent block structure model of \cite{aicher2014learning} and the weighted stochastic block model of \cite{peixoto2018nonparametric}. These two models however suffer from the same drawback as standard stochastic block models, namely the fact that a node can belong to only one class, which is not realistic for many networks. Mixed-membership block models were specifically designed to overcome this limitation and we propose here a new mixed-membership block model adapted to weighted networks. One important aspect in designing a generative model for networks is to develop a scalable inference method so that the model can be applied on large networks. We rely in this study on collapsed variational inference coupled with stochastic variational inference to do so.
